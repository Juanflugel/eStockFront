!function(){"use strict";angular.module("services",["ngResource"]).factory("$loStorage",function(){var e={todos:[],vacios:[],cleanLS:function(){window.localStorage.clear()},setObject:function(e,t){window.localStorage.setItem(e,angular.toJson(t))},getObject:function(e){return JSON.parse(window.localStorage.getItem(e))},removeObject:function(e){window.localStorage.removeItem(e)}};return e}).factory("Config",function(){return{version:"0.0.1",ip:"www.estock.website",port:5006,protocol:"http"}}).factory("shop",["$resource","Config",function(e,t){var o,s={},r=[],n=[],i=[];return{prueba:e("http://"+t.ip+":"+t.port+"/handleProjects"),list:e("http://"+t.ip+":"+t.port+"/items"),items:e("http://"+t.ip+":"+t.port+"/items",{}),itemsInserted:e("http://"+t.ip+":"+t.port+"/insertedItems",{}),itemsCode:e("http://"+t.ip+":"+t.port+"/itemsCode",{}),itemidUpdate:e("http://"+t.ip+":"+t.port+"/items",{},{update:{method:"PUT"}}),project:e("http://"+t.ip+":"+t.port+"/projects",{}),projectRequiredAmounts:e("http://"+t.ip+":"+t.port+"/requiredAmounts",{}),projectGeneralView:e("http://"+t.ip+":"+t.port+"/projectGeneralView",{}),projectUpdate:e("http://"+t.ip+":"+t.port+"/projects",{},{update:{method:"PUT"}}),assembly:e("http://"+t.ip+":"+t.port+"/assemblies",{}),assemblyUpdate:e("http://"+t.ip+":"+t.port+"/assemblies",{},{update:{method:"PUT"}}),company:e("http://"+t.ip+":"+t.port+"/company",{}),companyInfoUpdate:e("http://"+t.ip+":"+t.port+"/company",{},{update:{method:"PUT"}}),passCompanyInfo:function(e){s=e,i=s.companyItemFilters,n=s.companyProviders,r=s.companyUsers,o=s.companyId},getCompanyId:function(){return o},getCompanyProviders:function(){return n},getCompanyEmployees:function(){return r},getCompanyFilters:function(){return i}}}]).factory("handleProjects",[function(){var e={},t={};return{passProject:function(t){e=t},passAssembly:function(e){t=e},getCurrentProject:function(){return e},getCurrentAssembly:function(){return t},getJustCode:function(e){var t=[];return _.each(e,function(e){var o=e.itemCode;t.push(o)}),t},resumeCodeAndAmount:function(e){var t=[];return _.each(e,function(e){var o=[e.itemCode,e.itemAmount];t.push(o)}),t},subtract2arrays:function(e,t){var o=[],s=t.length;return _.each(e,function(e){for(var r=0;r<s;r++){var n=t[r];e[0]===n[0]&&o.push([e[0],e[1]-n[1]])}}),o},checkIfNegative:function(e){var t=[];return _.each(e,function(e){e[1]<0&&t.push(e)}),t},addAmountFromStock:function(e,t){var o=[],s=t.length;return _.each(e,function(e){for(var r=0;r<s;r++){var n=t[r];e.itemCode===n.itemCode&&(e.stockAmount=n.itemAmount,o.push(e))}}),o},addInsertedAmount:function(e,t){var o=[],s=e.length;return _.each(t,function(t){for(var r=0;r<s;r++){var n=e[r];t.itemCode===n.itemCode&&(n.insertedAmount=t.itemAmount,o.push(n))}}),o}}}])}(),function(){"use strict";angular.module("menuModule",[]).controller("menuCtrl",["$scope","$timeout","$mdSidenav","$log",function(e,t,o,s){function r(o,s){var r;return function(){var n=e,i=Array.prototype.slice.call(arguments);t.cancel(r),r=t(function(){r=void 0,o.apply(n,i)},s||10)}}function n(e){return r(function(){o(e).toggle().then(function(){})},200)}function i(e){return function(){o(e).toggle().then(function(){})}}e.toggleLeft=n("left"),e.toggleRight=i("right"),e.isOpenRight=function(){return o("right").isOpen()},e.close=function(){o("left").close().then(function(){s.debug("close RIGHT is done")})}}])}(),function(){"use strict";angular.module("pendingsModule",[]).controller("pendingsCtrl",["$scope","shop",function(e,t){e.header={itemCode:"Item Code",itemAmount:"Stock",itemType:"Type",itemName:"Name",itemBuyPrice:"Price",itemProvider:"Provider"};var o={};o.companyId="RMB01",o.projectState="open",e.filtrar={itemType:"SCHRAUBE"},e.queryItems=function(){var t={};t[e.filterModel.queryObjKey]=e.queryTag,console.log(t),e.filtrar=t},t.prueba.query(o,function(s){console.log(s.length,new Date,o),e.collection=s,e.filterBy=t.getCompanyFilters()},function(e){console.log(e)})}]).directive("pendingsViewHeader",[function(){return{restrict:"E",templateUrl:"pendingsView/pendingsViewHeader.html"}}]).directive("pendingsTable",[function(){return{restrict:"E",templateUrl:"pendingsView/pendingsTable.html",link:function(e){e.order=function(t){e.reverse=e.predicate===t&&!e.reverse,e.predicate=t}}}}])}(),function(){"use strict";angular.module("settingsModule",[]).controller("settingsCtrl",["$scope","shop","handleProjects",function(e,t,o){e.createAssembly=!1;var s={itemType:"SCHRAUBE"};e.loadFilter=function(){e.firmaId=t.getCompanyId(),e.filterBy=t.getCompanyFilters(),e.assembliesList=e.filterBy[3].array,e.providersList=e.filterBy[1].array},e.queryData=function(){t.items.query(s,function(t){e.collection=t;var s=o.getJustCode(e.collection);s.push("0"),e.insertedItems(s)},function(e){console.log(e)})},e.refresh=function(){e.loadFilter(),s.companyId=e.firmaId,e.queryData()},e.firmaId=t.getCompanyId(),e.firmaId&&e.refresh(),e.$on("companyInfoAvailable",function(){e.refresh()}),e.queryByFilter=function(){var t={};t[e.filterModel.queryObjKey]=e.queryTag,s=t,s.companyId=e.firmaId,e.queryData()},e.queryByCode=function(){s={},s.companyId=e.firmaId,s.itemCode=e.search,t.itemsCode.query(s,function(t){e.collection=t;var s=o.getJustCode(e.collection);s.push("0"),e.insertedItems(s)},function(e){console.log(e)})},e.insertedItems=function(s){var r={};r.companyId=e.firmaId,r.projectState="open",r.codesArray=s,t.itemsInserted.query(r,function(t){o.addInsertedAmount(e.collection,t)},function(e){console.log(e)})},e.header={itemCode:"Item Code",itemAmount:"Stock",insertedAmount:"Assembled",itemType:"Type",itemName:"Name",itemBuyPrice:"Price"},e.editObj=function(t){t.itemLastDate=new Date(t.itemLastDate),e.obj=t,e.createAssembly=!1,e.newItem=!1,e.viewItem=!1,e.justInfo=!1,e.editItem=!0},e.readObj=function(t){t.itemLastDate=new Date(t.itemLastDate),e.obj=t,e.createAssembly=!1,e.newItem=!1,e.editItem=!1,e.justInfo=!0,e.viewItem=!0},e.deleteObj=function(o,s){var r=confirm("Are you sure to delete Item: "+o.itemName);r===!0&&t.items.remove({_id:o._id},function(t){e.collection.splice(s,1),alert("Item: "+t.itemName+" successfully deleted"),e.refresh()})},e.createObj=function(o){o.companyId=e.firmaId,t.items.save(o,function(t){t&&(e.obj={},e.newItem=!1)},function(e){console.log(e)})},e.updateObj=function(o){var s=o._id;t.itemidUpdate.update({_id:s},o,function(){e.editItem=!1},function(e){alert("The item amount was not updated:"+e)})},e.newAssembly=function(){e.createAssembly=!0,e.newItem=!1,e.viewItem=!1,e.justInfo=!1,e.editItem=!1},e.itemsNewAssembly=[],e.refreshFilter=function(){e.itemsToInsert=_.filter(e.collection,function(e){return e.insert===!0})},e.insertItemInAssembly=function(){e.itemsNewAssembly.push.apply(e.itemsNewAssembly,e.itemsToInsert)},e.createNewAssembly=function(){var o={};o.assemblyName=e.assembly.projectName,o.assemblyNumber=e.assembly.projectNumber,o.assemblyItems=e.itemsNewAssembly,o.companyId=e.firmaId,o.assemblyName&&(t.assembly.save(o,function(e){console.log("todo bien primo se creo esa monda"+e)},function(e){alert("error"+e)}),e.createAssembly=!1)}}]).directive("newAssemblyHeader",[function(){return{restrict:"E",templateUrl:"settingsView/newAssemblyHeader.html"}}]).directive("settingsViewHeader",[function(){return{restrict:"E",templateUrl:"settingsView/settingsViewHeader.html"}}]).directive("iForm",[function(){return{restrict:"E",templateUrl:"settingsView/iForm.html"}}]).directive("contenteditable",function(){return{require:"ngModel",link:function(e,t,o,s){t.bind("blur",function(){e.$apply(function(){s.$setViewValue(t.html())})}),s.$render=function(){t.html(s.$viewValue)}}}}).directive("iTable",[function(){return{restrict:"E",templateUrl:"settingsView/itable.html",link:function(e){e.order=function(t){e.reverse=e.predicate===t&&!e.reverse,e.predicate=t}}}}])}(),function(){"use strict";angular.module("projectsModule",["services"]).controller("projectsCtrl",["$scope","shop","$location","$anchorScroll",function(e,t,o,s){e.firmaId=t.getCompanyId(),e.progressBarInsertAssemblydisable=!0,e.projectQuery=function(o,s){e.progressBardisable=!1;var r={};r.companyId=e.firmaId,r.projectState=s||"open",t.project.query(r,function(t){e.projects=t,e.projectInfo=e.projects[o]||e.projects[0]||{projectName:"No Open Projects"},e.projectsAssemblies=e.projectInfo.projectAssemblies||[],e.showProjectAssemblies(e.projectInfo),e.progressBardisable=!0,e.progressBarInsertAssemblydisable=!0},function(e){console.log(e)})},e.firmaId&&e.projectQuery(),e.$on("companyInfoAvailable",function(){e.firmaId=t.getCompanyId(),e.projectQuery()}),e.gotoHash=function(e){var t=e;o.hash()!==t?o.hash(e):s()},e.showProjectAssemblies=function(t){e.projectInfo=t,e.projectsAssemblies=e.projectInfo.projectAssemblies,_.each(e.projectsAssemblies,function(e){var t=e.assemblyItems,o=_.reject(t,function(e){return e.itemAssembled===!0});e.pendingToBeAssembled=o.length,e.completed=(t.length-o.length)/t.length*100})},e.createNewProject=function(o){e.progressBardisable=!1,o.projectState="open",o.companyId="RMB01",t.project.save(o,function(t){console.log(t),e.startNewProject=!1,e.projects.push(t),e.progressBardisable=!0,e.obj={}})},e.editProjectObj=function(t){console.log(t),e.obj=t,e.startNewProject=!1,e.editProject=!0,e.gotoHash("top")},e.updateProject=function(o){e.progressBardisable=!1;var s=o._id;o.projectNumber=o.projectNumber.toUpperCase(),t.projectUpdate.update({_id:s},o,function(t){console.log(t),e.editProject=!1,e.progressBardisable=!0,e.obj={}})},e.closeProject=function(o){var s=o._id;o.projectState="closed",t.projectUpdate.update({_id:s},o,function(t){console.log(t),e.projectQuery(),e.editProject=!1})},e.deleteProjects=function(o){var s=confirm("Are you sure to delete Item: "+o.projectName);s===!0&&t.project.remove({_id:o._id},function(){console.log("borrado"),e.projectQuery()},function(e){console.log(e)})}}]).directive("projectListCard",[function(){return{restrict:"E",templateUrl:"projectsView/projectListCard.html"}}]).directive("projectDetails",[function(){return{restrict:"E",templateUrl:"projectsView/projectListCard.html"}}])}(),function(){"use strict";angular.module("projectsAssemblyDetailModule",["services"]).controller("projectsAssemblyDetailCtrl",["$scope","handleProjects",function(e,t){e.header={itemStatus:"Status",itemCode:"Item Code",neededAmount:"Amount",itemName:"Name"},e.currentProject=t.getCurrentProject(),e.assemblies=e.currentProject.projectAssemblies,e.currentAssembly=t.getCurrentAssembly(),e.collection=e.currentAssembly.assemblyItems,e.seeAssembliesDetails=function(o){t.passAssembly(o),e.currentAssembly=o,e.collection=e.currentAssembly.assemblyItems,console.log(e.collection.length)},e.order=function(t){e.reverse=e.predicate===t&&!e.reverse,e.predicate=t}}])}(),function(){"use strict";angular.module("projectsDetailsModule",["services"]).controller("ProjectDetailsCtrl",["$scope","shop","handleProjects",function(e,t,o){e.callAssemblies=function(){var o={};o.companyId=e.firmaId,t.assembly.query(o,function(t){e.collection=t},function(e){console.log(e)})},e.showAssemblies=function(){e.callAssemblies(),e.insertNewAssembly=!0},e.header={assemblyName:"Assembly Name",assemblyNumber:"Assembly Number",numberOfparts:"Parts"},e.refreshFilter=function(){e.assembliesToInsert=_.filter(e.collection,function(e){return e.insert===!0})},e.insertarAssemnliesInProject=function(){e.progressBarInsertAssemblydisable=!1;var o=e.projectInfo._id,s=e.assembliesToInsert;t.projectUpdate.update({_id:o},s,function(){e.assembliesToInsert=[],e.callAssemblies();var t=e.projects.indexOf(e.projectInfo);e.projectQuery(t),e.insertNewAssembly=!1},function(e){console.log(e)})},e.passAssembly=function(t){o.passAssembly(t),o.passProject(e.projectInfo)}}])}(),function(){"use strict";angular.module("assembliesModule",["services"]).controller("assembliesCtrl",["$scope","shop","$location","$anchorScroll",function(e,t,o,s){e.header={itemCode:"Item Code",neededAmount:"Amount",itemName:"Name"},e.assembliesQuery=function(){var o={};o.companyId=e.firmaId,e.progressBardisable=!1,t.assembly.query(o,function(t){e.assemblies=t,e.assemblyInfo=e.assemblies[0],e.collection=e.assemblyInfo.assemblyItems,e.progressBardisable=!0},function(e){console.log(e)})},e.gotoHash=function(e){var t=e;o.hash()!==t?o.hash(e):s()},e.firmaId=t.getCompanyId(),e.firmaId&&e.assembliesQuery(),e.$on("companyInfoAvailable",function(){e.firmaId=t.getCompanyId(),e.assembliesQuery()}),e.editAssembly=function(t){e.Objassembly=t,e.editAssemblyInfo=!0,e.gotoHash("assemblyForm")},e.closeForm=function(){o.hash("top"),s("top")},e.updateAssemblyInfo=function(o){var s=o._id;o.assemblyName=o.assemblyName.toUpperCase(),t.assemblyUpdate.update({_id:s},o,function(t){console.log(t),e.editAssemblyInfo=!1},function(e){alert(e)})},e.createAssembly=function(o){o.companyId=e.firmaId,t.assembly.save(o,function(t){console.log(t),e.startNewAssembly=!1,e.assembliesQuery()})},e.deleteAssembly=function(o){var s=confirm("Are you sure to delete Assembly: "+o.assemblyName);if(s===!0){var r={};r.companyId=e.firmaId,r._id=o._id,console.log(r),t.assembly.remove(r,function(){e.assembliesQuery()},function(e){console.log(e)})}},e.showAssemblyItems=function(t){e.assemblyInfo=t,e.collection=t.assemblyItems,e.gotoHash("assemblyForm")},e.editObj=function(t){e.obj=t,e.insertObjInAssembly=!1,e.editObjInAssembly=!0,e.gotoHash("assemblyForm")},e.newObj=function(){e.obj={},e.editObjInAssembly=!1,e.insertObjInAssembly=!0},e.insertItemInAssembly=function(o){console.log(o);var s={};s.companyId=e.firmaId,s.assemblyNumber=e.assemblyInfo.assemblyNumber,t.assemblyUpdate.update(s,o,function(t){console.log(t),e.assemblyInfo=t,e.collection=e.assemblyInfo.assemblyItems,e.insertObjInAssembly=!1},function(e){console.log(e)})},e.updateItemInAssembly=function(o){var s={};s.companyId=e.firmaId,s.assemblyNumber=e.assemblyInfo.assemblyNumber,s["assemblyItems._id"]=o._id,t.assemblyUpdate.update(s,o,function(){e.editObjInAssembly=!1},function(e){console.log(e)})},e.deleteItemFromAssembly=function(o){var s=confirm("Are you sure to delete Item: "+o.itemCode);if(s===!0){var r={};r.companyId=e.firmaId,r.assemblyNumber=e.assemblyInfo.assemblyNumber,r.itemCode=o.itemCode,console.log(r),t.assemblyUpdate.update(r,o,function(){e.collection.splice(e.collection.indexOf(o),1)},function(e){console.log(e)})}}}]).directive("assembliesListCard",[function(){return{restrict:"E",templateUrl:"assembliesView/assembliesListCard.html"}}]).directive("assemblyDetailsHeader",[function(){return{restrict:"E",templateUrl:"assembliesView/assemblyDetailsHeader.html"}}]).directive("assemblyTable",[function(){return{restrict:"E",templateUrl:"assembliesView/assemblyTable.html",link:function(e){e.order=function(t){e.reverse=e.predicate===t&&!e.reverse,e.predicate=t}}}}])}(),function(){"use strict";angular.module("eStockFront",["templates","ui.router","ngMaterial","services","menuModule","settingsModule","pendingsModule","projectsModule","projectsAssemblyDetailModule","projectsDetailsModule","assembliesModule"]).run(["shop","$rootScope",function(e,t){var o="RMB01";e.company.query({companyId:o},function(o){console.log("from run",o[0]),e.passCompanyInfo(o[0]),t.$broadcast("companyInfoAvailable")})}]).config(["$stateProvider","$urlRouterProvider",function(e,t){t.otherwise("/app/Settings"),t.when("/app/Projects","/app/Projects/Details"),e.state("app",{abstract:!0,url:"/app",templateUrl:"menu/menu.html",controller:"menuCtrl"}).state("app.Settings",{url:"/Settings",templateUrl:"settingsView/settingsView.html",controller:"settingsCtrl"}).state("app.Pendings",{url:"/Pendings",templateUrl:"pendingsView/pendingsView.html",controller:"pendingsCtrl"}).state("app.Projects",{url:"/Projects",templateUrl:"projectsView/projectsView.html",controller:"projectsCtrl"}).state("app.Projects.Details",{url:"/:id",templateUrl:"projectsView/projectDetails.html",controller:"ProjectDetailsCtrl"}).state("app.assemblyDetails",{url:"/Projects/:pId/:idAssembly",templateUrl:"projectsView/projectAssembliesDetails.html",controller:"projectsAssemblyDetailCtrl"}).state("app.Assemblies",{url:"/Assemblies",templateUrl:"assembliesView/assembliesView.html",controller:"assembliesCtrl"})}])}();